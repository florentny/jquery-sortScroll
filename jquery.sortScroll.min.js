!function(t,s,n,o){"use strict";function e(s,n){this.container=t(s),this.settings=t.extend({},r,n,this.container.data()),this._sorting=!1,this.elementClass="sort-scroll-element",this.sortingClass="sort-scroll-sorting",this.buttonUpClass="sort-scroll-button-up",this.buttonDownClass="sort-scroll-button-down",this.init()}var r={animationDuration:1e3,cssEasing:"ease-in-out",keepStill:!0};t.extend(e.prototype,{init:function(){var s=this;s.container.on("click","."+s.buttonUpClass+", ."+s.buttonDownClass,function(n){n.preventDefault();var o,e=t(this),r=s.container.find("."+s.elementClass),i=r.index(e.closest("."+s.elementClass));o=e.hasClass(s.buttonUpClass)?-1:1,s.sortElement(i,o,s.settings.keepStill)})},sortElement:function(o,e,r){e=-1===e?e:1,r=r?this.settings.keepStill:!1;var i=this,a=i.container.find("."+i.elementClass),l=a.length-1,c=o+e;if(0>c||c>l)return!1;if(i._sorting)return i.container.one("sortScroll.sortEnd",function(t,s,n,o){i.sortElement(o,e,r)}),!1;a.each(function(){t(this).css("top",0)});var u=a.eq(o),f=u.outerHeight(!0),p=u.offset().top,h=a.eq(c),d=h.outerHeight(!0),g=h.offset().top,m=h.offset().top,v=g+f,C=0,y=parseInt(h.css("margin-top"),10);e>0&&(m=p+d,v=p,C=parseInt(u.css("margin-top"),10),y=0);var E,b=m-p-C,S=v-g-y,x=i.settings.animationDuration,w=i.settings.cssEasing,D=t("body"),T=u.attr("style")||"",k=h.attr("style")||"",H=D.attr("style")||"",_=u.css("z-index"),M=t.Deferred(),U=t.Deferred(),q=t.Deferred(),z="transitionend webkitTransitionEnd msTransitionEnd oTransitionEnd";if(E="auto"===_?2:_+1,i.container.trigger("sortScroll.sortStart",[u,o,c]),i._sorting=!0,u.add(h).css({position:"relative",transition:x+"ms "+w}),u.addClass(i.sortingClass).css({"z-index":E,top:b+"px"}),h.css({top:S+"px"}),r){var I=t(s).scrollTop(),j=I+b,A=Math.max(0,n.documentElement.scrollHeight-n.documentElement.clientHeight);j=Math.min(j,A),j=Math.max(j,0),D.css({transition:x+"ms "+w,"margin-top":I-j+"px"})}u.on(z,function(){M.resolve()}),h.on(z,function(){U.resolve()}),D.on(z,function(){q.resolve()}),t.when(M,U,q).done(function(){u.attr("style",T),h.attr("style",k),D.attr("style",H),r&&t("html, body").scrollTop(j+(t(s).scrollTop()-I)),u.removeClass(i.sortingClass),e>0?h.after(u):h.before(u),i._sorting=!1,i.container.trigger("sortScroll.sortEnd",[u,o,c])})}}),t.fn.sortScroll=function(s){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var o=t(this),r=o.data("sortScroll");r?"string"==typeof s&&r[s].apply(r,n):o.data("sortScroll",new e(this,s))})},t(".sort-scroll-container").each(function(){t(this).sortScroll()})}(jQuery,window,document);
